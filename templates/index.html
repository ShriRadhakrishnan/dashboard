<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Chart Viewer</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
    <h1>Stock Chart Viewer</h1>
    <div id="chart"></div>
    <div id="test-chart"></div>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<!-- <script>
    const testData = {
        x: ["2025-01-01", "2025-01-02", "2025-01-03"],
        y: [150, 155, 160],
        type: "scatter",
    };

    Plotly.newPlot("test-chart", [testData]);
</script> -->


    <script>
async function loadChart() {
    const symbol = "{{ symbol }}";
    try {
        const response = await fetch("/get_stock_data", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ symbol })
        });

        if (!response.ok) {
            console.error("Failed to fetch stock data:", response.statusText);
            document.getElementById("chart").innerHTML = `<p>Error loading data for ${symbol}.</p>`;
            return;
        }

        const data = await response.json();
        console.log("Received data:", data);

        // Use Plotly to render the chart dynamically
        const chartData = [{
            x: data.dates,
            y: data.prices,
            mode: 'lines',
            name: `${data.symbol} Stock Price`
        }];

        const layout = {
            title: `${data.symbol} Stock Price`,
            xaxis: { title: "Date" },
            yaxis: { title: "Price" }
        };

        Plotly.newPlot("chart", chartData, layout);
    } catch (error) {
        console.error("Error in loadChart():", error);
        document.getElementById("chart").innerHTML = "<p>Error loading chart.</p>";
    }
}

loadChart();


    </script>
    
</body>
</html>


